{
  "version": 4,
  "terraform_version": "1.10.1",
  "serial": 8,
  "lineage": "eaac8a47-9955-e8e5-e04d-766b5069d35d",
  "outputs": {
    "mgmt_vm_ips": {
      "value": [
        "10.134.12.201"
      ],
      "type": [
        "tuple",
        [
          "string"
        ]
      ]
    },
    "ssh_config": {
      "value": "# Host Machine\nHost host\n    HostName 10.134.12.201\n    User almalinux\n    IdentityFile ~/.ssh/id_rsa                    # Correct SSH private key\n    ProxyJump condenser-proxy\n\n# Worker Machines\nHost worker1\n    HostName 10.134.12.87\n    User almalinux\n    IdentityFile ~/.ssh/id_rsa                    # Correct SSH private key\n    ProxyJump condenser-proxy\n\nHost worker2\n    HostName 10.134.12.38\n    User almalinux\n    IdentityFile ~/.ssh/id_rsa                    # Correct SSH private key\n    ProxyJump condenser-proxy\n\nHost worker3\n    HostName 10.134.12.225\n    User almalinux\n    IdentityFile ~/.ssh/id_rsa                    # Correct SSH private key\n    ProxyJump condenser-proxy\n\n# Storage Machine\nHost storage\n    HostName 10.134.12.115\n    User almalinux\n    IdentityFile ~/.ssh/id_rsa                    # Correct SSH private key\n    ProxyJump condenser-proxy\n",
      "type": "string"
    },
    "storage_vm_ips": {
      "value": [
        "10.134.12.115"
      ],
      "type": [
        "tuple",
        [
          "string"
        ]
      ]
    },
    "worker_vm_ips": {
      "value": [
        "10.134.12.87",
        "10.134.12.38",
        "10.134.12.225"
      ],
      "type": [
        "tuple",
        [
          "string",
          "string",
          "string"
        ]
      ]
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "harvester_image",
      "name": "img",
      "provider": "provider[\"registry.terraform.io/harvester/harvester\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "",
            "display_name": "almalinux-9.4-20240805",
            "id": "harvester-public/image-bp52g",
            "message": "",
            "name": "image-bp52g",
            "namespace": "harvester-public",
            "progress": 100,
            "pvc_name": "",
            "pvc_namespace": "",
            "size": 591724544,
            "source_type": "download",
            "state": "Active",
            "storage_class_name": "harvester-longhorn",
            "storage_class_parameters": {
              "migratable": "true",
              "numberOfReplicas": "3",
              "staleReplicaTimeout": "30"
            },
            "tags": {},
            "url": "https://repo.almalinux.org/almalinux/9/cloud/x86_64/images/AlmaLinux-9-GenericCloud-9.4-20240805.x86_64.qcow2",
            "volume_storage_class_name": "longhorn-image-bp52g"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "harvester_cloudinit_secret",
      "name": "cloud_config",
      "provider": "provider[\"registry.terraform.io/harvester/harvester\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "",
            "id": "ucabbaa-comp0235-ns/ucabbaa-ucl-ac-uk-cloudinit-fe5cdf19",
            "message": null,
            "name": "ucabbaa-ucl-ac-uk-cloudinit-fe5cdf19",
            "namespace": "ucabbaa-comp0235-ns",
            "network_data": null,
            "network_data_base64": "",
            "state": null,
            "tags": null,
            "timeouts": null,
            "user_data": "#cloud-config\n\n# 1. Your \u0026 Markerâ€™s Keys for All VMs\nssh_authorized_keys:\n  - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDEGYMIHQdWQv/nwFf7zN2Pue60T+Outmr202vz3/DPAA+ufAWfo9FRw4r4dR44jFZpqmwIm2GCIH/JmB9/ETJsYgOJLBhxC+1Dea75jsQh7deYIcyfJQKJpnb0S5FJbg2+6H3jfGLj/MvoU/tVVqz2lNOmpApSj7B0Npo/qkea/3kzXhFz8Bhu4K1Glr0bh1d4YYLQ20SrSpFR+uGcwkKuOBMX12T25tNPADQ+Wi/nVK7jD9124oqcpgCGLDHWpSULX/AYCxCqMQOih3Kb2B6x7OPnCxXPpQugAOJ7zclfdRVpVN07RAPJKjMpVeQ+87EEH5ZFWpuOortUrrGE8xac+OsDOzQzmNCkchcq6rhs3YuPb/U86a6RswimkOGl/J2wT4Dd9npnCtkNyhFKc1Ucr+z63qQ/Pc0binfmgQ9XpX6A0FdMHs0d2XQzgKMjtDVfEEfclVO9ieGUMziDDdNzSce9xeAKWFyXZGXX3kBvmYDJOcs0HRjggUQXhmrHmbff6hkCd8qn2yoTIHtBgSH8VCR0tbT8UEyJFmqrBRt5qdDk4ITiPomdxOcEmdG9ivPtcDgcvP5RMNwUSBbEMWPGn7SHv36Glzm0t4Z4PPZouLr8pnrBzR9xUrd/5soyul0XkkcRGeA9Nj5ChtSsTMZbK26sk3UQjwNCm3+arAouSw== abdullah.alotaishan@kcl.ac.uk\n  - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMd6wccFYaxf5Mn/Hk5MyRQvugd+FJuWJnvLt8wecr7S dbuchan@ML-RJKH0G50C0.local\n\n# 2. Commands for first boot on any VM\nruncmd:\n  # 2.1. Basic setup (same as old approach)\n  - yum install -y epel-release\n  - yum install -y ansible git\n\n  # 2.2. Clone the Git repository (same as old approach)\n  - git clone https://github.com/Alotaishanab/data-pipeline.git /home/almalinux/data-pipeline\n\n  # 2.3. Additional step (mainly relevant on Host):\n  #     Generate an Ansible key inside the Host, so it can do internal ansible tasks.\n  #     This won't break Workers/Storage if run there, but you can ignore it on them.\n  - ssh-keygen -t ed25519 -q -N \"\" -f /home/almalinux/.ssh/ansible_ed25519\n  - cat /home/almalinux/.ssh/ansible_ed25519.pub \u003e\u003e /home/almalinux/.ssh/authorized_keys\n  - chown almalinux:almalinux /home/almalinux/.ssh/ansible_ed25519*\n\n  # Optionally, you can place an ansible.cfg or do more host-only steps here.\n",
            "user_data_base64": ""
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAsImRlZmF1bHQiOjEyMDAwMDAwMDAwMCwiZGVsZXRlIjoxMjAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "random_id.secret"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "harvester_virtualmachine",
      "name": "mgmt",
      "provider": "provider[\"registry.terraform.io/harvester/harvester\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cloudinit": [
              {
                "network_data": "",
                "network_data_base64": "",
                "network_data_secret_name": "",
                "type": "noCloud",
                "user_data": "",
                "user_data_base64": "",
                "user_data_secret_name": "ucabbaa-ucl-ac-uk-cloudinit-fe5cdf19"
              }
            ],
            "cpu": 2,
            "description": "Management Node",
            "disk": [
              {
                "access_mode": "ReadWriteMany",
                "auto_delete": true,
                "boot_order": 1,
                "bus": "virtio",
                "container_image_name": "",
                "existing_volume_name": "",
                "hot_plug": false,
                "image": "harvester-public/image-bp52g",
                "name": "rootdisk",
                "size": "10Gi",
                "storage_class_name": "longhorn-image-bp52g",
                "type": "disk",
                "volume_mode": "Block",
                "volume_name": "ucabbaa-ucl-ac-uk-mgmt-fe5cdf19-rootdisk-pf7l2"
              }
            ],
            "efi": true,
            "hostname": "ucabbaa-ucl-ac-uk-mgmt-fe5cdf19",
            "id": "ucabbaa-comp0235-ns/ucabbaa-ucl-ac-uk-mgmt-fe5cdf19",
            "input": [],
            "machine_type": "q35",
            "memory": "4Gi",
            "message": null,
            "name": "ucabbaa-ucl-ac-uk-mgmt-fe5cdf19",
            "namespace": "ucabbaa-comp0235-ns",
            "network_interface": [
              {
                "interface_name": "eth0",
                "ip_address": "10.134.12.201",
                "mac_address": "a6:89:34:b5:4c:f7",
                "model": "virtio",
                "name": "nic-1",
                "network_name": "ucabbaa-comp0235-ns/ds4eng",
                "type": "bridge",
                "wait_for_lease": true
              }
            ],
            "node_name": "harvester-rkwch",
            "reserved_memory": "100Mi",
            "restart_after_update": true,
            "run_strategy": "RerunOnFailure",
            "secure_boot": false,
            "ssh_keys": null,
            "start": null,
            "state": "Ready",
            "tags": null,
            "timeouts": null,
            "tpm": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAsImRlZmF1bHQiOjEyMDAwMDAwMDAwMCwiZGVsZXRlIjozMDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "data.harvester_image.img",
            "harvester_cloudinit_secret.cloud_config",
            "random_id.secret"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "harvester_virtualmachine",
      "name": "storage",
      "provider": "provider[\"registry.terraform.io/harvester/harvester\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cloudinit": [
              {
                "network_data": "",
                "network_data_base64": "",
                "network_data_secret_name": "",
                "type": "noCloud",
                "user_data": "",
                "user_data_base64": "",
                "user_data_secret_name": "ucabbaa-ucl-ac-uk-cloudinit-fe5cdf19"
              }
            ],
            "cpu": 4,
            "description": "Storage Node",
            "disk": [
              {
                "access_mode": "ReadWriteMany",
                "auto_delete": true,
                "boot_order": 1,
                "bus": "virtio",
                "container_image_name": "",
                "existing_volume_name": "",
                "hot_plug": false,
                "image": "harvester-public/image-bp52g",
                "name": "rootdisk",
                "size": "10Gi",
                "storage_class_name": "longhorn-image-bp52g",
                "type": "disk",
                "volume_mode": "Block",
                "volume_name": "ucabbaa-ucl-ac-uk-storage-fe5cdf19-rootdisk-h7q9p"
              },
              {
                "access_mode": "ReadWriteMany",
                "auto_delete": true,
                "boot_order": 0,
                "bus": "virtio",
                "container_image_name": "",
                "existing_volume_name": "",
                "hot_plug": false,
                "image": "",
                "name": "datadisk",
                "size": "200Gi",
                "storage_class_name": "harvester-longhorn",
                "type": "disk",
                "volume_mode": "Block",
                "volume_name": "ucabbaa-ucl-ac-uk-storage-fe5cdf19-datadisk-hsrnt"
              }
            ],
            "efi": true,
            "hostname": "ucabbaa-ucl-ac-uk-storage-fe5cdf19",
            "id": "ucabbaa-comp0235-ns/ucabbaa-ucl-ac-uk-storage-fe5cdf19",
            "input": [],
            "machine_type": "q35",
            "memory": "8Gi",
            "message": null,
            "name": "ucabbaa-ucl-ac-uk-storage-fe5cdf19",
            "namespace": "ucabbaa-comp0235-ns",
            "network_interface": [
              {
                "interface_name": "eth0",
                "ip_address": "10.134.12.115",
                "mac_address": "b2:82:ef:cb:94:7f",
                "model": "virtio",
                "name": "nic-1",
                "network_name": "ucabbaa-comp0235-ns/ds4eng",
                "type": "bridge",
                "wait_for_lease": true
              }
            ],
            "node_name": "harvester-kwnxc",
            "reserved_memory": "100Mi",
            "restart_after_update": true,
            "run_strategy": "RerunOnFailure",
            "secure_boot": false,
            "ssh_keys": null,
            "start": null,
            "state": "Ready",
            "tags": null,
            "timeouts": null,
            "tpm": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAsImRlZmF1bHQiOjEyMDAwMDAwMDAwMCwiZGVsZXRlIjozMDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "data.harvester_image.img",
            "harvester_cloudinit_secret.cloud_config",
            "random_id.secret"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "harvester_virtualmachine",
      "name": "worker",
      "provider": "provider[\"registry.terraform.io/harvester/harvester\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "cloudinit": [
              {
                "network_data": "",
                "network_data_base64": "",
                "network_data_secret_name": "",
                "type": "noCloud",
                "user_data": "",
                "user_data_base64": "",
                "user_data_secret_name": "ucabbaa-ucl-ac-uk-cloudinit-fe5cdf19"
              }
            ],
            "cpu": 4,
            "description": "Worker Node",
            "disk": [
              {
                "access_mode": "ReadWriteMany",
                "auto_delete": true,
                "boot_order": 1,
                "bus": "virtio",
                "container_image_name": "",
                "existing_volume_name": "",
                "hot_plug": false,
                "image": "harvester-public/image-bp52g",
                "name": "rootdisk",
                "size": "25Gi",
                "storage_class_name": "longhorn-image-bp52g",
                "type": "disk",
                "volume_mode": "Block",
                "volume_name": "ucabbaa-ucl-ac-uk-worker-1-fe5cdf19-rootdisk-8g2qc"
              }
            ],
            "efi": true,
            "hostname": "ucabbaa-ucl-ac-uk-worker-1-fe5cdf19",
            "id": "ucabbaa-comp0235-ns/ucabbaa-ucl-ac-uk-worker-1-fe5cdf19",
            "input": [],
            "machine_type": "q35",
            "memory": "32Gi",
            "message": null,
            "name": "ucabbaa-ucl-ac-uk-worker-1-fe5cdf19",
            "namespace": "ucabbaa-comp0235-ns",
            "network_interface": [
              {
                "interface_name": "eth0",
                "ip_address": "10.134.12.87",
                "mac_address": "1a:ca:2e:d8:9f:34",
                "model": "virtio",
                "name": "nic-1",
                "network_name": "ucabbaa-comp0235-ns/ds4eng",
                "type": "bridge",
                "wait_for_lease": true
              }
            ],
            "node_name": "harvester-cvsj8",
            "reserved_memory": "100Mi",
            "restart_after_update": true,
            "run_strategy": "RerunOnFailure",
            "secure_boot": false,
            "ssh_keys": null,
            "start": null,
            "state": "Ready",
            "tags": null,
            "timeouts": null,
            "tpm": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAsImRlZmF1bHQiOjEyMDAwMDAwMDAwMCwiZGVsZXRlIjozMDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "data.harvester_image.img",
            "harvester_cloudinit_secret.cloud_config",
            "random_id.secret"
          ]
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "cloudinit": [
              {
                "network_data": "",
                "network_data_base64": "",
                "network_data_secret_name": "",
                "type": "noCloud",
                "user_data": "",
                "user_data_base64": "",
                "user_data_secret_name": "ucabbaa-ucl-ac-uk-cloudinit-fe5cdf19"
              }
            ],
            "cpu": 4,
            "description": "Worker Node",
            "disk": [
              {
                "access_mode": "ReadWriteMany",
                "auto_delete": true,
                "boot_order": 1,
                "bus": "virtio",
                "container_image_name": "",
                "existing_volume_name": "",
                "hot_plug": false,
                "image": "harvester-public/image-bp52g",
                "name": "rootdisk",
                "size": "25Gi",
                "storage_class_name": "longhorn-image-bp52g",
                "type": "disk",
                "volume_mode": "Block",
                "volume_name": "ucabbaa-ucl-ac-uk-worker-2-fe5cdf19-rootdisk-54cjw"
              }
            ],
            "efi": true,
            "hostname": "ucabbaa-ucl-ac-uk-worker-2-fe5cdf19",
            "id": "ucabbaa-comp0235-ns/ucabbaa-ucl-ac-uk-worker-2-fe5cdf19",
            "input": [],
            "machine_type": "q35",
            "memory": "32Gi",
            "message": null,
            "name": "ucabbaa-ucl-ac-uk-worker-2-fe5cdf19",
            "namespace": "ucabbaa-comp0235-ns",
            "network_interface": [
              {
                "interface_name": "eth0",
                "ip_address": "10.134.12.38",
                "mac_address": "7e:65:f6:97:bb:36",
                "model": "virtio",
                "name": "nic-1",
                "network_name": "ucabbaa-comp0235-ns/ds4eng",
                "type": "bridge",
                "wait_for_lease": true
              }
            ],
            "node_name": "harvester-vl2vh",
            "reserved_memory": "100Mi",
            "restart_after_update": true,
            "run_strategy": "RerunOnFailure",
            "secure_boot": false,
            "ssh_keys": null,
            "start": null,
            "state": "Ready",
            "tags": null,
            "timeouts": null,
            "tpm": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAsImRlZmF1bHQiOjEyMDAwMDAwMDAwMCwiZGVsZXRlIjozMDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "data.harvester_image.img",
            "harvester_cloudinit_secret.cloud_config",
            "random_id.secret"
          ]
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "cloudinit": [
              {
                "network_data": "",
                "network_data_base64": "",
                "network_data_secret_name": "",
                "type": "noCloud",
                "user_data": "",
                "user_data_base64": "",
                "user_data_secret_name": "ucabbaa-ucl-ac-uk-cloudinit-fe5cdf19"
              }
            ],
            "cpu": 4,
            "description": "Worker Node",
            "disk": [
              {
                "access_mode": "ReadWriteMany",
                "auto_delete": true,
                "boot_order": 1,
                "bus": "virtio",
                "container_image_name": "",
                "existing_volume_name": "",
                "hot_plug": false,
                "image": "harvester-public/image-bp52g",
                "name": "rootdisk",
                "size": "25Gi",
                "storage_class_name": "longhorn-image-bp52g",
                "type": "disk",
                "volume_mode": "Block",
                "volume_name": "ucabbaa-ucl-ac-uk-worker-3-fe5cdf19-rootdisk-ssg25"
              }
            ],
            "efi": true,
            "hostname": "ucabbaa-ucl-ac-uk-worker-3-fe5cdf19",
            "id": "ucabbaa-comp0235-ns/ucabbaa-ucl-ac-uk-worker-3-fe5cdf19",
            "input": [],
            "machine_type": "q35",
            "memory": "32Gi",
            "message": null,
            "name": "ucabbaa-ucl-ac-uk-worker-3-fe5cdf19",
            "namespace": "ucabbaa-comp0235-ns",
            "network_interface": [
              {
                "interface_name": "eth0",
                "ip_address": "10.134.12.225",
                "mac_address": "32:cf:7c:75:95:60",
                "model": "virtio",
                "name": "nic-1",
                "network_name": "ucabbaa-comp0235-ns/ds4eng",
                "type": "bridge",
                "wait_for_lease": true
              }
            ],
            "node_name": "harvester-mh9pg",
            "reserved_memory": "100Mi",
            "restart_after_update": true,
            "run_strategy": "RerunOnFailure",
            "secure_boot": false,
            "ssh_keys": null,
            "start": null,
            "state": "Ready",
            "tags": null,
            "timeouts": null,
            "tpm": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAsImRlZmF1bHQiOjEyMDAwMDAwMDAwMCwiZGVsZXRlIjozMDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMCwidXBkYXRlIjoxMjAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "data.harvester_image.img",
            "harvester_cloudinit_secret.cloud_config",
            "random_id.secret"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_id",
      "name": "secret",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "b64_std": "/lzfGQ==",
            "b64_url": "_lzfGQ",
            "byte_length": 4,
            "dec": "4267499289",
            "hex": "fe5cdf19",
            "id": "_lzfGQ",
            "keepers": null,
            "prefix": null
          },
          "sensitive_attributes": []
        }
      ]
    }
  ],
  "check_results": null
}
